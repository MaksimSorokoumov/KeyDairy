# KeyDairy

KeyDairy — демонстрационный проект для безопасного ведения журнала клавиатуры с шифрованием. В реальном использовании учитывайте юридические и этические аспекты.

## Содержание
- [Поддержка](#поддержка)
- [Установка](#установка)
- [Сборка exe](#сборка-exe)
- [Генерация иконки](#генерация-иконки)
- [Автозапуск](#автозапуск)
- [Безопасность](#безопасность)
- [Примеры использования](#примеры-использования)
- [Лицензия](#лицензия)

## Поддержка
- Вопросы и предложения отправляйте в репозиторий

## Установка
1. Создайте виртуальное окружение и активируйте его.
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Убедитесь, что у вас установлен Python 3.11+

## Сборка exe
1. Установите PyInstaller в активированном окружении:
   ```bash
   pip install pyinstaller
   ```
2. Сгенерируйте иконку (см. раздел «Генерация иконки»).
3. Соберите exe:
   ```powershell
   pyinstaller --noconsole --onefile --name KeyDairy \
     --add-data "config.json;." --add-data "logs;logs" \
     --hidden-import=pystray --hidden-import=pynput.keyboard --hidden-import=win32timezone \
     --icon=icon.ico main_keylogger.py
   ```
4. После сборки файл будет в `dist\KeyDairy.exe`.

## Генерация иконки
- Иконка создаётся через скрипт `make_icon.py`. Чтобы сгенерировать `icon.ico`, запустите:
   ```bash
   python make_icon.py
   ```
- Убедитесь, что `icon.ico` присутствует в корне проекта перед сборкой. if отсутствует, PyInstaller выдаёт ошибку.

## Автозапуск
- Способ 1: ярлык в автозагрузке текущего пользователя
  ```powershell
  $target = "C:\path\to\dist\KeyDairy.exe"
  $lnk = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\KeyDairy.lnk"
  $WshShell = New-Object -ComObject WScript.Shell
  $Shortcut = $WshShell.CreateShortcut($lnk)
  $Shortcut.TargetPath = $target
  $Shortcut.WorkingDirectory = Split-Path $target
  $Shortcut.Save()
  ```
- Способ 2: реестр Run (HKCU) — для текущего пользователя
  ```powershell
  New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "KeyDairy" -Value `"C:\path\to\dist\KeyDairy.exe`" -PropertyType String
  ```
- Важно: запуск требует наличии прав администратора для HKLM, но для HKCU достаточно обычных прав.

## Безопасность
- DEK хранится в шифрованном виде и доступ к просмотру журналов требует ввода пароля.
- Пароли и обертки защищены DPAPI и PBKDF2; не храните пароли в коде и в открытом виде.
- Это демо-решение. При публикации учитывайте ответственность и законность использования.

## Примеры использования
- Просмотр журналов через GUI после аутентификации:
  - При клике по меню в трее нажмите "Открыть просмотр логов" и введите пароль.
- Конвертация раскладки в тексте журнала:
  - В логе можно применить кнопку "Конверт раскладки" для перевода латинских символов в кириллицу по раскладке.

## Локальная разработка и тесты
- Убедитесь, что в папке `logs/` создаются тестовые файлы, можно использовать `log_viewer.py` для локального просмотра тестовых логов.

## Лицензия
- Этот проект распространяется по лицензии MIT 

---

**Помните**: Этот инструмент должен использоваться только на компьютерах, которыми вы владеете, или с явного разрешения владельца. Несанкционированное использование кейлогеров незаконно.
